!function(){function a(a,b){"use strict";var c={};c.version="1.1.0-dev",c.constants={DEFAULT_MOVING_AVERAGE_NODES:2};var c=c||{};c.accumulateGroupForNDayMovingAverage=function(a,d,e){if(!a||!a.all||"function"!=typeof a.all)throw new Error("You must pass in a crossfilter group!");d="undefined"!=typeof d?d:c.constants.DEFAULT_MOVING_AVERAGE_NODES,e="undefined"!=typeof e?!!e:!1;var f=function(a){return a.key},g=function(a){return a.value};return{ndays:function(a){return"undefined"==typeof a?d:void(d=a)},_debug:function(a){return"undefined"==typeof a?e:void(e=a)},all:function(){var b=0,c=a.all(),f=c.map(function(a,c,f){for(var g=d,h=0,i=0,j=0,k=[];--g>0;){var l=f[c-g];l&&(h++,i+=l.value,e&&k.push({key:l.key,value:l.value}))}h++,i+=a.value,e&&(b+=a.value,k.push({key:a.key,value:a.value})),j=i/h;var m={key:a.key,value:a.value,rollingAverage:j};return e&&(m._debug={cumulate:b,thisResult:k}),m});return f},top:function(){var c=0,h=a.top.apply(a,arguments),i={},j=b(h),k=j.dimension(function(a){return a.key}),l=k.group(),m=l.reduce(function(a,b){var c=f(b),d=g(b);return i[c]?i[c].myValue+=d:i[c]={myValue:d},a},function(a,b){var c=f(b),d=g(b);return i[c]?i[c].quantity-=d:delete i[c],a},function(){i={}});m.all();var n=h.map(function(a){for(var b=Object.keys(i).sort(),g=b.indexOf(f(a)),h=d,j=0,k=0,l=0,m=[];--h>0;){var n=b[g-h];if(n){var o=i[n],p=o.myValue;j++,k+=p,e&&m.push({key:n,value:p})}}j++,k+=a.value,e&&(c+=a.value,m.push({key:a.key,value:a.value})),l=k/j;var q={key:a.key,value:a.value,rollingAverage:l};return e&&(q._debug={cumulate:c,thisResult:m}),q});return n}}};var c=c||{};return c.accumulateGroupForPercentageChange=function(a,c){if(!a||!a.all||"function"!=typeof a.all)throw new Error("You must pass in a crossfilter group!");c="undefined"!=typeof c?!!c:!1;var d=function(a){return a.key},e=function(a){return a.value};return{_debug:function(a){return"undefined"==typeof a?c:void(c=a)},all:function(){var f=a.all(),g={},h=b(f),i=h.dimension(function(a){return a.key}),j=i.group(),k=j.reduce(function(a,b){var c=d(b),f=e(b);return g[c]?g[c].myValue+=f:g[c]={myValue:f},a},function(a,b){var c=d(b),f=e(b);return g[c]?g[c].quantity-=f:delete g[c],a},function(){g={}});k.all();var l=f.map(function(a,b,d){var f=a,g=d[b-1],h=0;if(g){var i=e(f)-e(g);if(0!==i){var j=i/e(g);h=100*j}else h=0}var k={key:a.key,value:a.value,percentageChange:h};return c&&(k._debug={thisDayKey:f.key,thisDayValue:f.value,prevDayKey:g?g.key:"None",prevDayValue:g?g.value:"None"}),k});return l},top:function(){var f=a.top.apply(a,arguments),g={},h=b(f),i=h.dimension(function(a){return a.key}),j=i.group(),k=j.reduce(function(a,b){var c=d(b),f=e(b);return g[c]?g[c].myValue+=f:g[c]={myValue:f},a},function(a,b){var c=d(b),f=e(b);return g[c]?g[c].quantity-=f:delete g[c],a},function(){g={}});k.all();var l=f.map(function(a){var b,f=a,h=0,i=Object.keys(g).sort(),j=i.indexOf(d(a)),k=i[j-1];if(k){var l=g[k];b=l.myValue;var m=e(f)-b;if(0!==m){var n=m/b;h=100*n}else h=0}var o={key:a.key,value:a.value,percentageChange:h};return c&&(o._debug={thisDayKey:f.key,thisDayValue:f.value,prevDayKey:k?k:"None",prevDayValue:k?b:"None"}),o});return l}}},c.d3=a,c.crossfilter=b,c}if("function"==typeof define&&define.amd)define(["d3","crossfilter"],a);else if("object"==typeof module&&module.exports){var b=require("d3"),c=require("crossfilter");"function"!=typeof c&&(c=c.crossfilter),module.exports=a(b,c)}else this["crossfilter-ma"]=a(d3,crossfilter)}();
//# sourceMappingURL=crossfilter-ma.min.js.map