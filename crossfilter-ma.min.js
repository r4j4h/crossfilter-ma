!function(){function a(a){"use strict";function b(a,b){1===a?b.sort(function(a,b){return a.rollingAverage>b.rollingAverage?1:a.rollingAverage<b.rollingAverage?-1:0}):-1===a&&b.sort(function(a,b){return a.rollingAverage>b.rollingAverage?-1:a.rollingAverage<b.rollingAverage?1:0})}function c(a,b){1===a?b.sort(function(a,b){return a.percentageChange>b.percentageChange?1:a.percentageChange<b.percentageChange?-1:0}):-1===a&&b.sort(function(a,b){return a.percentageChange>b.percentageChange?-1:a.percentageChange<b.percentageChange?1:0})}var d={};d.version="1.2.2",d.constants={DEFAULT_MOVING_AVERAGE_NODES:2};var d=d||{};d.accumulateGroupForNDayMovingAverage=function(c,e,f,g){if(!c||!c.all||"function"!=typeof c.all)throw new Error("You must pass in a crossfilter group!");e="undefined"!=typeof e?e:d.constants.DEFAULT_MOVING_AVERAGE_NODES,g="undefined"!=typeof g?!!g:!1,f="undefined"!=typeof f?!!f:!1;var h,i,j=!1;return{ndays:function(a){return"undefined"==typeof a?e:void(e=a)},rolldown:function(a){return"undefined"==typeof a?f:void(f=!!a)},_debug:function(a){return"undefined"==typeof a?g:void(g=!!a)},_defaultKeyAccessor:function(){return function(a){return a.key}},_defaultValueAccessor:function(){return function(a){return a.value}},keyAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof h&&(h=this._defaultKeyAccessor()),h):void(h=a)},valueAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof i&&(i=this._defaultValueAccessor()),i):void(i=a)},orderByMovingAverage:function(a){if("undefined"==typeof a)return j;switch(a){case 1:j=1;break;case-1:j=-1;break;default:case 0:j=!1}},all:function(){var d=this,h=0,i=c.all(),k={},l=a(i),m=l.dimension(function(a){return a.key}),n=m.group(),o=n.reduce(function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return k[c]?k[c].myValue+=e:k[c]={myValue:e},a},function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return k[c]?k[c].quantity-=e:delete k[c],a},function(){k={}});o.all();var p=Object.keys(k).sort(),q=i.map(function(a){for(var b=d.keyAccessor()(a),c=d.valueAccessor()(a),i=p.indexOf(b),j=e,l=0,m=0,n=0,o=[];--j>0;){var q=p[i-j];if(!q&&!f)break;if(q){var r=k[q],s=r.myValue;l++,m+=s,g&&o.push({key:q,value:s})}}l++,m+=c,g&&(h+=c,o.push({key:b,value:c})),n=m/l,e>l&&!f&&(n=0);var t={key:b,value:c,rollingAverage:n};return g&&(t._debug={cumulate:h,datumsUsed:o}),t});return b(j,q),q},top:function(){var d=this,h=0,i=c.top.apply(c,arguments),k={},l=a(i),m=l.dimension(function(a){return a.key}),n=m.group(),o=n.reduce(function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return k[c]?k[c].myValue+=e:k[c]={myValue:e},a},function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return k[c]?k[c].quantity-=e:delete k[c],a},function(){k={}});o.all();var p=Object.keys(k).sort(),q=i.map(function(a){for(var b=d.keyAccessor()(a),c=d.valueAccessor()(a),i=p.indexOf(b),j=e,l=0,m=0,n=0,o=[];--j>0;){var q=p[i-j];if(!q&&!f)break;if(q){var r=k[q],s=r.myValue;l++,m+=s,g&&o.push({key:q,value:s})}}l++,m+=c,g&&(h+=c,o.push({key:b,value:c})),n=m/l,e>l&&!f&&(n=0);var t={key:b,value:c,rollingAverage:n};return g&&(t._debug={cumulate:h,datumsUsed:o}),t});return b(j,q),q}}};var d=d||{};return d.accumulateGroupForPercentageChange=function(b,d){if(!b||!b.all||"function"!=typeof b.all)throw new Error("You must pass in a crossfilter group!");d="undefined"!=typeof d?!!d:!1;var e,f,g=!1;return{_debug:function(a){return"undefined"==typeof a?d:void(d=!!a)},_defaultKeyAccessor:function(){return function(a){return a.key}},_defaultValueAccessor:function(){return function(a){return a.value}},keyAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof e&&(e=this._defaultKeyAccessor()),e):void(e=a)},valueAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof f&&(f=this._defaultValueAccessor()),f):void(f=a)},orderByPercentageChange:function(a){if("undefined"==typeof a)return g;switch(a){case 1:g=1;break;case-1:g=-1;break;default:case 0:g=!1}},all:function(){var e=this,f=b.all(),h={},i=a(f),j=i.dimension(function(a){return a.key}),k=j.group(),l=k.reduce(function(a,b){var c=e.keyAccessor()(b),d=e.valueAccessor()(b);return h[c]?h[c].myValue+=d:h[c]={myValue:d},a},function(a,b){var c=e.keyAccessor()(b),d=e.valueAccessor()(b);return h[c]?h[c].quantity-=d:delete h[c],a},function(){h={}});l.all();var m=Object.keys(h).sort(),n=f.map(function(a){var b,c=a,f=0,g=m.indexOf(e.keyAccessor()(a)),i=m[g-1];if(i){var j=h[i];b=j.myValue;var k=e.valueAccessor()(c)-b;if(0!==k){var l=k/b;f=100*l}else f=0}var n={key:a.key,value:a.value,percentageChange:f};return d&&(n._debug={thisDayKey:c.key,thisDayValue:c.value,prevDayKey:i?i:"None",prevDayValue:b?b:"None"}),n});return c(g,n),n},top:function(){var e=this,f=b.top.apply(b,arguments),h={},i=a(f),j=i.dimension(function(a){return a.key}),k=j.group(),l=k.reduce(function(a,b){var c=e.keyAccessor()(b),d=e.valueAccessor()(b);return h[c]?h[c].myValue+=d:h[c]={myValue:d},a},function(a,b){var c=e.keyAccessor()(b),d=e.valueAccessor()(b);return h[c]?h[c].quantity-=d:delete h[c],a},function(){h={}});l.all();var m=Object.keys(h).sort(),n=f.map(function(a){var b,c=a,f=0,g=m.indexOf(e.keyAccessor()(a)),i=m[g-1];if(i){var j=h[i];b=j.myValue;var k=e.valueAccessor()(c)-b;if(0!==k){var l=k/b;f=100*l}else f=0}var n={key:a.key,value:a.value,percentageChange:f};return d&&(n._debug={thisDayKey:c.key,thisDayValue:c.value,prevDayKey:i?i:"None",prevDayValue:i?b:"None"}),n});return c(g,n),n}}},d.crossfilter=a,d}if("function"==typeof define&&define.amd)define(["crossfilter"],a);else if("object"==typeof module&&module.exports){var b=require("crossfilter");"function"!=typeof b&&(b=b.crossfilter),module.exports=a(b)}else this["crossfilter-ma"]=a(crossfilter),this.crossfilter$ma=this["crossfilter-ma"]}();
//# sourceMappingURL=crossfilter-ma.min.js.map