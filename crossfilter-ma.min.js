!function(){function a(a){"use strict";var b={};b.version="1.2.1",b.constants={DEFAULT_MOVING_AVERAGE_NODES:2};var b=b||{};b.accumulateGroupForNDayMovingAverage=function(c,d,e,f){if(!c||!c.all||"function"!=typeof c.all)throw new Error("You must pass in a crossfilter group!");d="undefined"!=typeof d?d:b.constants.DEFAULT_MOVING_AVERAGE_NODES,f="undefined"!=typeof f?!!f:!1,e="undefined"!=typeof e?!!e:!1;var g,h;return{ndays:function(a){return"undefined"==typeof a?d:void(d=a)},rolldown:function(a){return"undefined"==typeof a?e:void(e=!!a)},_debug:function(a){return"undefined"==typeof a?f:void(f=!!a)},_defaultKeyAccessor:function(){return function(a){return a.key}},_defaultValueAccessor:function(){return function(a){return a.value}},keyAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof g&&(g=this._defaultKeyAccessor()),g):void(g=a)},valueAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof h&&(h=this._defaultValueAccessor()),h):void(h=a)},all:function(){var b=this,g=0,h=c.all(),i={},j=a(h),k=j.dimension(function(a){return a.key}),l=k.group(),m=l.reduce(function(a,c){var d=b.keyAccessor()(c),e=b.valueAccessor()(c);return i[d]?i[d].myValue+=e:i[d]={myValue:e},a},function(a,c){var d=b.keyAccessor()(c),e=b.valueAccessor()(c);return i[d]?i[d].quantity-=e:delete i[d],a},function(){i={}});m.all();var n=Object.keys(i).sort(),o=h.map(function(a){for(var c=b.keyAccessor()(a),h=b.valueAccessor()(a),j=n.indexOf(c),k=d,l=0,m=0,o=0,p=[];--k>0;){var q=n[j-k];if(!q&&!e)break;if(q){var r=i[q],s=r.myValue;l++,m+=s,f&&p.push({key:q,value:s})}}l++,m+=h,f&&(g+=h,p.push({key:c,value:h})),o=m/l,d>l&&!e&&(o=0);var t={key:c,value:h,rollingAverage:o};return f&&(t._debug={cumulate:g,datumsUsed:p}),t});return o},top:function(){var b=this,g=0,h=c.top.apply(c,arguments),i={},j=a(h),k=j.dimension(function(a){return a.key}),l=k.group(),m=l.reduce(function(a,c){var d=b.keyAccessor()(c),e=b.valueAccessor()(c);return i[d]?i[d].myValue+=e:i[d]={myValue:e},a},function(a,c){var d=b.keyAccessor()(c),e=b.valueAccessor()(c);return i[d]?i[d].quantity-=e:delete i[d],a},function(){i={}});m.all();var n=Object.keys(i).sort(),o=h.map(function(a){for(var c=b.keyAccessor()(a),h=b.valueAccessor()(a),j=n.indexOf(c),k=d,l=0,m=0,o=0,p=[];--k>0;){var q=n[j-k];if(!q&&!e)break;if(q){var r=i[q],s=r.myValue;l++,m+=s,f&&p.push({key:q,value:s})}}l++,m+=h,f&&(g+=h,p.push({key:c,value:h})),o=m/l,d>l&&!e&&(o=0);var t={key:c,value:h,rollingAverage:o};return f&&(t._debug={cumulate:g,datumsUsed:p}),t});return o}}};var b=b||{};return b.accumulateGroupForPercentageChange=function(b,c){if(!b||!b.all||"function"!=typeof b.all)throw new Error("You must pass in a crossfilter group!");c="undefined"!=typeof c?!!c:!1;var d,e;return{_debug:function(a){return"undefined"==typeof a?c:void(c=!!a)},_defaultKeyAccessor:function(){return function(a){return a.key}},_defaultValueAccessor:function(){return function(a){return a.value}},keyAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof d&&(d=this._defaultKeyAccessor()),d):void(d=a)},valueAccessor:function(a){return"undefined"==typeof a?("undefined"==typeof e&&(e=this._defaultValueAccessor()),e):void(e=a)},all:function(){var d=this,e=b.all(),f={},g=a(e),h=g.dimension(function(a){return a.key}),i=h.group(),j=i.reduce(function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return f[c]?f[c].myValue+=e:f[c]={myValue:e},a},function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return f[c]?f[c].quantity-=e:delete f[c],a},function(){f={}});j.all();var k=Object.keys(f).sort(),l=e.map(function(a){var b,e=a,g=0,h=k.indexOf(d.keyAccessor()(a)),i=k[h-1];if(i){var j=f[i];b=j.myValue;var l=d.valueAccessor()(e)-b;if(0!==l){var m=l/b;g=100*m}else g=0}var n={key:a.key,value:a.value,percentageChange:g};return c&&(n._debug={thisDayKey:e.key,thisDayValue:e.value,prevDayKey:i?i:"None",prevDayValue:b?b:"None"}),n});return l},top:function(){var d=this,e=b.top.apply(b,arguments),f={},g=a(e),h=g.dimension(function(a){return a.key}),i=h.group(),j=i.reduce(function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return f[c]?f[c].myValue+=e:f[c]={myValue:e},a},function(a,b){var c=d.keyAccessor()(b),e=d.valueAccessor()(b);return f[c]?f[c].quantity-=e:delete f[c],a},function(){f={}});j.all();var k=Object.keys(f).sort(),l=e.map(function(a){var b,e=a,g=0,h=k.indexOf(d.keyAccessor()(a)),i=k[h-1];if(i){var j=f[i];b=j.myValue;var l=d.valueAccessor()(e)-b;if(0!==l){var m=l/b;g=100*m}else g=0}var n={key:a.key,value:a.value,percentageChange:g};return c&&(n._debug={thisDayKey:e.key,thisDayValue:e.value,prevDayKey:i?i:"None",prevDayValue:i?b:"None"}),n});return l}}},b.crossfilter=a,b}if("function"==typeof define&&define.amd)define(["crossfilter"],a);else if("object"==typeof module&&module.exports){var b=require("crossfilter");"function"!=typeof b&&(b=b.crossfilter),module.exports=a(b)}else this["crossfilter-ma"]=a(crossfilter),this.crossfilter$ma=this["crossfilter-ma"]}();
//# sourceMappingURL=crossfilter-ma.min.js.map